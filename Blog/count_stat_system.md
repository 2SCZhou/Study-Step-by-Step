how to design a scalability count stat system
============================================
### 业务需求
很多应用程序都有通知或系统消息的功能模块，如果有新消息会以红点或消息条数在某个显眼位置展示给用户，这是计数系统使用场景之一。应用内部，比如微博，每个用户有自己发送微博数量，微博评价数等需要计数的需求，这也是计数系统常见的使用场景。将普遍需要的计数功能独立出一个单独的模块或系统，有利用系统的扩展，所以本文将讨论下如何构建一个可伸缩的计数系统。

先对上述计数常见使用场景简要分析。第一种情况，如果有新消息，应用会显示消息条数或直接显示红点，比如CSDN通知栏的做法，这种场景需要的是消息的增量信息。第二种情况，比如微博计数统计，每个微博的转发数，评价数，这些场景需要的是消息的全量信息。因此，我们要设计的计数系统需要支持全量和增量的统计，还需要支持对不同类型消息的计数。

### 简要设计
 从需求中我们可以抽象出一个item概念，它表示一个消息类型及该消息类型支持的key数量，对全量和增量支持的flag，表结构如下：
+-----------+----------+---------+------+
| item_type | key_size | comment | flag |
+-----------+----------+---------+------+
| t         |        2 | test    |    3 |
+-----------+----------+---------+------+

